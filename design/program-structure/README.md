# 程序结构
## 1.1.完整的程序结构  
一个完整的汇编语言程序在结构上必须做到：  
* 用方式选择伪指令说明执行该程序的微处理器类型。
* 用段定义语句定义每一个逻辑段。
* 用ASSUME语句说明段约定。
* 用汇编结束语句说明程序结束。


## 1.2.完整段定义格式
```
.8086			;方式定义
DATA	SEGMENT USE16			;定义数据段
			...
DATA ENDS

CODE SEGMENT USE16			;定义代码段
	ASSUME CS:CODE,DS:DATA		;说明段约定
BEG:MOV AX,DATA
    MOV DS,AX
			...
    MOV AH,4CH
    INT 21H			;返回DOS
CODE ENDS
```

## 2.1.方式选择伪指令
功能：通过汇编程序，源程序经过汇编链接后生成哪一中CPU类型的机器指令。  
例如：  
`.8086`  
注：  
不设置伪指令与设置.8086是等价的。  

## 2.2.段定义语句
格式：  
```
段名	SEGMENT	定位参数	链接参数	‘分类名’	段长度	段体
段名	ENDS
```
功能：是逻辑段的定界语句，源程序中每一个逻辑段都必须用定界语句定界。  
定位参数、链接参数、‘分类名’：为源程序的汇编、链接提供必要的信息。  
段长度：有两种描述方式可选：  
* USE16:表示该逻辑段长度最大允许64k，单元的有效地址为16位，访问该逻辑段采用16位寻址方式。
* USE32：表示该逻辑段长度超过64k，单元的有效地址为32位，访问该逻辑段采用32位寻址方式。
说明：  
模块化程序中必须考虑各模块之间的同名段的定位方式和链接方式。对于单一模块的程序不需要考虑这些问题。  
单一模块的程序，如果有堆栈段的话，堆栈段的链接属性应为STACK(因为只有STACK属性才表示该段是堆栈段)，分类名应为'STACK'，且不能省略。其他逻辑段的前3个属性参数都选用缺省方式。  
DOS环境下运行的程序选用USE16做段长度。  

## 2.3.段约定语句
格式：  
```
ASSUME	段寄存器:段名,......,段寄存器:段名
```
功能：  
ASSUME语句通知汇编程序，寻址逻辑段使用哪一个段寄存器。  
说明：  
ASSUME语句是非执行语句，要求放在代码段之中，执行寻址操作之前。习惯上，吧ASSUME语句作为代码段的第一条语句。ASSUME语句，仅仅是约定了对某个逻辑段进行寻址操作时使用哪一个寄存器，而段寄存器的初值还必须在程序中用指令设置。  

## 2.4.汇编结束语句
格式：  
```
END 程序的启动地址标号
```
例如：  
`END 	BEGIN`  
功能：  
通知汇编程序，源程序到此结束，用BEGIN作标号的指令是程序的启动指令。  
注意：  
在单一模块的源程序中，以及在模块化程序的主模块中必须用此格式作为源程序的最后一条语句。DOS装载程序的可执行文件（EXE）时，自动把标号BEGIN所在的段基址赋给CS，把BEGIN所在单元的偏移量赋给IP。从而CPU自动从BEGIN开始的那条指令依此执行程序。  

## 2.5.返回DOS语句
程序在完成预定任务后，必须返回DOS。返回DOS最常见的方法是使用DOS系统4CH功能调用，即连续执行以下2条指令：  
```
MOV AH,4CH
INT 21H
```
